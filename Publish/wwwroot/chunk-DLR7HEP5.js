import{B as n,E as l,Fb as m,H as o,Kb as U,j as a,m as u,p as c,sb as h,ub as p}from"./chunk-CVZN5AOS.js";var S=(()=>{let r=class r{constructor(t,e){this.http=t,this.router=e,this.baseUrl=U.apiUrl,this.currentUserSource=new a(1),this.currentUser$=this.currentUserSource.asObservable()}loadCurrentUser(t){if(t===null)return this.currentUserSource.next(null),u(null);let e=new h;return e=e.set("Authorization",`Bearer ${t}`),this.http.get(`${this.baseUrl}account`,{headers:e}).pipe(c(i=>i?(this.setUserAndToken(i),i):null))}login(t){return this.http.post(`${this.baseUrl}account/login`,t).pipe(n(e=>{this.setUserAndToken(e)}))}register(t){return this.http.post(`${this.baseUrl}account/register`,t).pipe(n(e=>{this.setUserAndToken(e)}))}logout(){localStorage.removeItem("token"),this.currentUserSource.next(null),this.router.navigateByUrl("/")}checkEmailExists(t){return this.http.get(`${this.baseUrl}account/email-exists?email=${t}`)}getUserAddress(){return this.http.get(`${this.baseUrl}account/address`)}updateUserAddress(t){return this.http.put(`${this.baseUrl}account/address`,t)}setUserAndToken(t){localStorage.setItem("token",t.token),this.currentUserSource.next(t)}};r.\u0275fac=function(e){return new(e||r)(o(p),o(m))},r.\u0275prov=l({token:r,factory:r.\u0275fac,providedIn:"root"});let s=r;return s})();export{S as a};
